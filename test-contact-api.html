<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact API Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3 class="mb-0">
                            <i class="fas fa-test-tube me-2"></i>
                            Contact API Test
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            This is a test form to verify the contact API integration is working properly.
                        </div>
                        
                        <form id="testContactForm" data-contact-form class="needs-validation" novalidate>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">First Name *</label>
                                    <input type="text" class="form-control" id="firstName" name="first_name" value="John" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">Last Name *</label>
                                    <input type="text" class="form-control" id="lastName" name="last_name" value="Doe" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="email" name="email" value="john.doe@example.com" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="phone" class="form-label">Phone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" value="+1-555-123-4567">
                                </div>
                                <div class="col-12">
                                    <label for="company" class="form-label">Company</label>
                                    <input type="text" class="form-control" id="company" name="company" value="Test Company Inc.">
                                </div>
                                <div class="col-12">
                                    <label for="product" class="form-label">Product Interest</label>
                                    <select class="form-select" id="product" name="product">
                                        <option value="">Select Product</option>
                                        <option value="outdoor" selected>Outdoor LED Displays</option>
                                        <option value="indoor">Indoor LED Displays</option>
                                        <option value="rental">Rental LED Displays</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label for="subject" class="form-label">Subject *</label>
                                    <input type="text" class="form-control" id="subject" name="subject" value="API Test Inquiry" required>
                                </div>
                                <div class="col-12">
                                    <label for="message" class="form-label">Message *</label>
                                    <textarea class="form-control" id="message" name="message" rows="4" required>This is a test message to verify that the contact API integration is working properly. Please ignore this test inquiry.</textarea>
                                </div>
                                <div class="col-12">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane me-2"></i>Test API Submit
                                    </button>
                                    <button type="button" class="btn btn-secondary ms-2" onclick="testAPIConnection()">
                                        <i class="fas fa-plug me-2"></i>Test API Connection
                                    </button>
                                </div>
                            </div>
                        </form>
                        
                        <div class="mt-4">
                            <h5>API Status</h5>
                            <div id="apiStatus" class="alert alert-secondary">
                                <i class="fas fa-clock me-2"></i>Ready to test...
                            </div>
                        </div>
                        
                        <div class="mt-3">
                            <h6>Backend Admin Panel</h6>
                            <a href="http://localhost:5000" target="_blank" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-external-link-alt me-2"></i>Open Admin Panel
                            </a>
                            <small class="text-muted ms-2">Login: admin / admin123</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/contact-api.js"></script>
    
    <script>
        // Test API connection
        async function testAPIConnection() {
            const statusDiv = document.getElementById('apiStatus');
            statusDiv.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Testing API connection...';
            statusDiv.className = 'alert alert-info';
            
            try {
                const response = await fetch('http://localhost:5000/api/stats');
                const result = await response.json();
                
                if (result.status === 'success') {
                    statusDiv.innerHTML = `
                        <i class="fas fa-check-circle me-2"></i>
                        API Connection Successful!<br>
                        <small>Products: ${result.stats.products} | Inquiries: ${result.stats.inquiries} | Quotes: ${result.stats.quotes}</small>
                    `;
                    statusDiv.className = 'alert alert-success';
                } else {
                    throw new Error(result.message || 'API returned error');
                }
            } catch (error) {
                statusDiv.innerHTML = `
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    API Connection Failed: ${error.message}<br>
                    <small>Make sure the admin server is running at localhost:5000</small>
                `;
                statusDiv.className = 'alert alert-danger';
            }
        }
        
        // Auto-test connection on page load
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(testAPIConnection, 1000);
        });
        
        // Enhanced form validation
        (function() {
            'use strict';
            window.addEventListener('load', function() {
                var forms = document.getElementsByClassName('needs-validation');
                var validation = Array.prototype.filter.call(forms, function(form) {
                    form.addEventListener('submit', function(event) {
                        event.preventDefault();
                        event.stopPropagation();
                        
                        if (form.checkValidity() === false) {
                            form.classList.add('was-validated');
                            return;
                        }
                        
                        // The contact-api.js will handle the actual submission
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>
</body>
</html>